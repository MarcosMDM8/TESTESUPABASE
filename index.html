<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Teste Supabase</title>
</head>
<body>
  <h1>Cadastro de Usuários</h1>

  <label for="nome">Nome:</label>
  <input type="text" id="nome" placeholder="Digite seu nome"><br><br>

  <label for="email">Email:</label>
  <input type="email" id="email" placeholder="Digite seu email"><br><br>

  <button onclick="cadastrarUsuario()">Cadastrar</button>
  <button onclick="listarUsuarios()">Atualizar Lista</button>

  <h2>Usuários cadastrados:</h2>
  <ul id="listaUsuarios"></ul>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    // 🔁 Substitua com a URL e API KEY reais do seu projeto:
    const supabaseUrl = 'https://jtsaijgncdiausfgytzi.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0c2FpamduY2RpYXVzZmd5dHppIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc0MTg2MDksImV4cCI6MjA2Mjk5NDYwOX0.2m3aNg7UUQCOOCXwNMGcyLtrzuN4Vp63mAEs2_1M3VM';

    const supabase = createClient(supabaseUrl, supabaseKey);

    // ⬇️ Função para cadastrar usuário
    window.cadastrarUsuario = async () => {
      const nome = document.getElementById('nome').value;
      const email = document.getElementById('email').value;

      if (!nome || !email) {
        alert('Preencha todos os campos!');
        return;
      }

      const { error } = await supabase.from('supabaseteste').insert([{ nome, email }]);

      if (error) {
        console.error('Erro ao cadastrar:', error);
        alert('Erro ao cadastrar: ' + error.message);
      } else {
        alert('Usuário cadastrado com sucesso!');
        document.getElementById('nome').value = '';
        document.getElementById('email').value = '';
        listarUsuarios();
      }
    };

    // ⬇️ Função para listar usuários
    window.listarUsuarios = async () => {
      const { data, error } = await supabase.from('supabaseteste').select('*');

      const lista = document.getElementById('listaUsuarios');
      lista.innerHTML = '';

      if (error) {
        console.error('Erro ao buscar usuários:', error);
        alert('Erro ao buscar: ' + error.message);
      } else {
        data.forEach(user => {
          const item = document.createElement('li');
          item.textContent = `${user.nome} - ${user.email}`;
          lista.appendChild(item);
        });
      }
    };
  </script>
</body>
</html>
