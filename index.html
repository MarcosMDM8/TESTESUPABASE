<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Teste Supabase</title>
</head>
<body>
  <h1>Cadastro de Usuários</h1>

  <label for="nome">Nome:</label>
  <input type="text" id="nome" placeholder="Digite seu nome"><br><br>

  <label for="email">Email:</label>
  <input type="email" id="email" placeholder="Digite seu email"><br><br>

  <button id="btnCadastrar">Cadastrar</button>
  <button id="btnListar">Atualizar Lista</button>

  <h2>Usuários cadastrados:</h2>
  <ul id="listaUsuarios"></ul>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    const supabaseUrl = 'https://jtsaijgncdiausfgytzi.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0c2FpamduY2RpYXVzZmd5dHppIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc0MTg2MDksImV4cCI6MjA2Mjk5NDYwOX0.2m3aNg7UUQCOOCXwNMGcyLtrzuN4Vp63mAEs2_1M3VM';
    const supabase = createClient(supabaseUrl, supabaseKey);

    // Função para cadastrar
    async function cadastrarUsuario() {
      const nome = document.getElementById('nome').value.trim();
      const email = document.getElementById('email').value.trim();

      if (!nome || !email) {
        alert('Preencha todos os campos!');
        return;
      }

      const { error } = await supabase
        .from('supabaseteste')
        .insert([{ nome, email }]);

      if (error) {
        console.error('Erro ao cadastrar:', error);
        alert('Erro: ' + error.message);
      } else {
        alert('Cadastrado com sucesso!');
        document.getElementById('nome').value = '';
        document.getElementById('email').value = '';
        listarUsuarios();
      }
    }

    // Função para listar
    async function listarUsuarios() {
      const lista = document.getElementById('listaUsuarios');
      lista.innerHTML = 'Carregando...';

      const { data, error } = await supabase
        .from('supabaseteste')
        .select('*');

      if (error) {
        console.error('Erro ao listar:', error);
        lista.innerHTML = 'Erro ao carregar lista.';
        return;
      }

      lista.innerHTML = '';
      data.forEach(user => {
        const li = document.createElement('li');
        li.textContent = `${user.nome} - ${user.email}`;
        lista.appendChild(li);
      });
    }

    // Espera carregar o DOM
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('btnCadastrar').addEventListener('click', cadastrarUsuario);
      document.getElementById('btnListar').addEventListener('click', listarUsuarios);
    });
  </script>
</body>
</html>
